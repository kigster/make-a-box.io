namespace :unicorn do
  desc 'Start Unicorn'
  task :start do    
    on roles(:app) do
      within current_path do
        execute "APP=#{fetch(:application)} RAILS_ENV=#{fetch(:stage)} bundle exec unicorn -c config/unicorn.rb -D"
      end
    end
  end
  desc 'Stop Unicorn'
  task :stop do
    on roles(:app) do
      execute "pkill -USR1 #{fetch(:application)}"
    end
  end

  desc 'Restart Unicorn'
  task :restart do
  end

  before :restart, :stop
  after :restart, :start
end
